<?page title="Home - Monte dei Paschi di Siena" contentType="text/html;charset=UTF-8"?>
<zk xmlns="http://www.zkoss.org/2005/zul">
    <window width="100%" height="100%"
            viewModel="@id('vm') @init('com.nttdata.viewmodel.HomeViewModel')"
            apply="org.zkoss.bind.BindComposer">

        <style src="/css/home.css" />
        <script src="/js/home.js" />

        <!-- Barra superiore -->
        <div sclass="navbar">
            <hbox>
                <image id="logoImg"
                       src="/images/logo.png"
                       height="45px"
                       style="margin-right:10px;" />
            </hbox>
            <hbox sclass="menu">
                <a href="#">Home</a>
                <a href="#">Servizi</a>
                <a href="#">Contatti</a>
            </hbox>
        </div>

        <!-- Layout principale -->
        <div sclass="main-layout">

            <!-- Sidebar -->
            <div sclass="sidebar">
                <button label="Ricarica" onClick="@command('loadProfiles')" />
            </div>

            <!-- Contenuto principale -->
            <div sclass="content-area">

                <label value="@load(vm.messaggio)"
                       style="font-size:16px; color:#333; margin-bottom:15px;" />

                <!-- 🔍 Barra di ricerca -->
                <hbox style="margin-bottom:10px;">
                    <textbox placeholder="Cerca per Target, Ent_code, Ent_value, Gruppo o APM..."
                             width="300px"
                             value="@bind(vm.searchText)" />
                    <button label="Cerca" onClick="@command('filterProfiles')"
                            style="margin-left:10px; background-color:#7b002c; color:white;
                                   border:none; padding:5px 10px; border-radius:4px;" />
                    <button label="Pulisci" onClick="@command('clearSearch')"
                            style="margin-left:10px; background-color:#7b002c; color:white;
                                   border:none; padding:5px 10px; border-radius:4px;" />
                </hbox>

                <!-- Tabella -->
                <div sclass="table-container">
                    <div sclass="table-header">
                        <label value="Elenco Profili"
                               style="font-weight:bold; font-size:14px; margin-bottom:5px;" />
                    </div>

                    <div id="tableScrollWrapper"
                         sclass="table-scroll-wrapper"
                         style="max-height:650px; overflow-y:auto;">

                        <grid id="gridProfili"
                              model="@bind(vm.filteredProfiles)"
                              emptyMessage="Nessun record trovato"
                              selection="@bind(vm.selectedProfile)"
                              sclass="wide-grid"
                              width="100%">

                            <columns sizable="false">
                                <column label="Target" width="20%" style="background-color:#7b002c; color:white;"/>
                                <column label="Ent_code" width="15%" style="background-color:#7b002c; color:white;"/>
                                <column label="Ent_value" width="15%" style="background-color:#7b002c; color:white;"/>
                                <column label="Gruppo" width="25%" style="background-color:#7b002c; color:white;"/>
                                <column label="APM" width="15%" style="background-color:#7b002c; color:white;"/>
                                <column label="Azioni" width="10%" style="background-color:#7b002c; color:white;"/>
                            </columns>

                            <template name="model">
                                <row>
                                    <label value="@load(each.target)" />
                                    <label value="@load(each.entCode)" />
                                    <label value="@load(each.entValue)" />
                                    <label value="@load(each.gruppo)" />
                                    <label value="@load(each.apm)" />

                                    <vbox spacing="5px">
                                        <button label="Modifica"
                                                onClick="@command('openEdit', entCode=each.entCode)"
                                                style="background-color:#7b002c;color:white;border:none;
                                                       padding:5px 10px;border-radius:4px;width:100%;" />
                                        <button label="Dettagli"
                                                onClick="@command('openDetails', entCode=each.entCode)"
                                                style="background-color:#7b002c;color:white;border:none;
                                                       padding:5px 10px;border-radius:4px;width:100%;" />
                                        <button label="Elimina"
                                                onClick="@command('confirmAndExecute',
                                                                  message='Sei sicuro di voler eliminare questo profilo?',
                                                                  commandName='deleteProfile',
                                                                  param=each)"
                                                style="background:#7b002c;color:white;border:none;
                                                       padding:5px 10px;border-radius:4px;width:100%;" />
                                    </vbox>
                                </row>
                            </template>

                        </grid>
                    </div>
                </div>
            </div>
        </div>

    </window>
</zk>
